<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<CSP name="map.CSP" application="/csp/iknowsocial/" default="1"><![CDATA[
<html>
<head>
  <title>Map Colorer</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="http://code.shutterstock.com/rickshaw/rickshaw.css">
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" >
  <link rel="stylesheet" href="custom.css">
  <style>
  .big-content-wrapper {
	  height: 38vh;
  }
  </style>
  <script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
  <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
  <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/rickshaw/1.5.1/rickshaw.min.js"></script>
  <script src="custom.js"></script>
  <script src="geo.js"></script>
  <script src="chart.js"></script>
  <script language="JavaScript">
  	var emotionalCircles = L.layerGroup([]);
    
    $(document).on("click", "#trends-table .link-to-full-source", function () {
	    #call(TWReader.UIBroker.AddMorePostsWithinContext(0, 100, $(this).text(), 1, "['title', 'EC']", "#map-table"))#
	});
  	
  	$(document).ready(function() {
	  	var map = L.map('map', {
      		center: [49, 32],
      		zoom: 5
    	});
    	
    	postCallback = function() {
  			posts = GeoPost.getFromPosts(posts);
  			console.log(posts);
    		for (var key in posts) {
	    		bindGeoPostMarker(posts[key], map);
    		}
    		drawEmotionalCircles(emotionalCircles, posts, map);
    		drawTrendsGraph(posts);
  		}
    	
    	L.tileLayer('http://a.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
      		attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> and <a href="http://geonames.org/">GeoNames</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
      		maxZoom: 18
    	}).addTo(map);
    	map.on('zoomend', function() {
    		drawEmotionalCircles(emotionalCircles, posts, map);
    	});
	});
  </script>
</head>
<body>
  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <a class="navbar-brand" href="#">Map Colorer</a>
      </div>
      <div class="collapse navbar-collapse">
      </div>
    </div>
  </nav>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
      	<div class="panel panel-default">
      		<div id="trends-chart"> </div>
      		
      	</div>
      	<div id="preview"></div>
      </div>
    </div>
    <div class="row" style="margin-top:10px">
      <div class="col-md-3">
        <div class="panel panel-default">
          <table class="table table-striped">
              <thead>
                <tr>
                  <th class="trends-source">Trends</th>
                </tr>
              </thead>
          </table>
          <div class="table-content big-content-wrapper">
            <table class="table table-striped" id="trends-table">
              <tbody>
              	 <script language="JavaScript">
              	 	#call(TWReader.UIBroker.DrawTrends("['sourceId']","#trends-table","46.4846","30.7326"))#
               </script>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="col-md-6">
      	<div class="panel panel-default">
        	<div id="map" class="panel-body big-content-wrapper"></div>
        	<div class="panel-footer">Circles?</div>
        </div>
      </div>
      <div class="col-md-3">
      	<div class="panel panel-default">
          <table class="table" id="map-table-header">
              <thead>
                <tr>
                  <th>Title</th>
                  <th>EC</th>
                </tr>
              </thead>
          </table>
          <div class="table-content big-content-wrapper">
            <table class="table" id="map-table">
              <tbody>
              	 <script language="JavaScript">
              	 	#call(TWReader.UIBroker.DrawTable("", "['title', 'EC']", "#map-table"))#
               </script>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

</body>
</html>
]]></CSP>
</Export>
